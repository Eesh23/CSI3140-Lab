<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script type="text/script"></script>
        <script>
            function validEmail() {
                document.getElementById("displayEmailError").innerHTML= "";
                document.getElementById("email").value = document.getElementById("eamil").value.toLowerCase();
                var emailRe = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/;
                if (!re.test(document.getElementById("email").value)) {
                    document.getElementById("dispalyEmailError").innerHTML = "<font color=\"red\">Invalid E-mail</font>";
                    return false;
                }
                return true;
            }

            function validateField(ref) {
                document.getElementById(ref.name + 'RequiredError').innerHTML = "";
                if (ref.value.length == 0){
                    document.getElementById(ref.name + 'RequiredError').innerHTML = "<font color=\"red\">Field  is required</font>";
                    return false;
                }
                if ((ref.name == "comments") && (ref.value == "Enter comments here.")){
                    document.getElementById(ref.name + 'RequiredError').innerHTML = "<font color=\"red\">Field  is required</font>";
                    return false;
                }
                return true;      
            }

            function validateAll(){
                var passed = validateField(document.getElementById("name"));
                if (passed){ 
                    passed = validateField(document.getElementById("email"));
                    if (passed){
                        passed = validateEmail();
                    }else{
                        validateEmail();
                    }
                } else{
                    validateField(document.getElementById("email"));
                }
                if (passed){
                    passed = validateField(document.getElementById("comments"));
                }else{
                    validateField(document.getElementById("comments"));
                } 
                if (passed){
                    ajaxFile.readFile();
                }
                return passed;
            }
            function ajaxRequest(url, cbFunc) {
                if (document.getElementById) {
                    var ajaxObj = (window.ActiveXObject) ? new ActiveXObject("Microsoft.XMLHTTP"): new XMLHttpRequest();
                }
                if (ajaxObj) { // if the ajaxObj object was successfully created?
                    ajaxObj.onreadystatechange = function() { // before making the request, set up a function to run whenever readyState changes    
                        if (ajaxObj.readyState == 4 && ajaxObj.status == 200) { // if true, then the request data has arrived
                            cbFunc(ajaxObj.responseXML); // pass the data to the callback function
                        }
                    }
                    ajaxObj.open("GET", url, true); // open server connection - GET request, requested URL, Asychronous set to true
                    ajaxObj.send(null); // send the request
                }
            }
            ajaxFile = {
                readFile:function (){
                    ajaxFile.firstName = document.getElementById("name").value;
                    ajaxFile.email = document.getElementById("email").value;
                    ajaxRequest('vaildEmail.xml',ajaxFile.cbReadFile);
                },
                cdReadFile: function (theData) {
                    emails = theData.getElementByTagName("email");
                    var validEmail = false;
                    var i=0;
                    for (i=0; i<emials.length;i++) {
                        if(ajaxFile.email.toLowerCase() == emails[i].childNode[0].nodeValue.toLowerCase()) {
                            validEmail = true;
                            break;
                        }
                    }
                    if (validEmail == false) {
                        document.getElementById("displayErrorEmail").innerHTML= "<font color=\"red\">E-mail is not registered !</font>";
                    } else {
                        document.getElementById("displayErrorEmail").innerHTML = "<font color=\"blue\">E-mail is registered into the valid emails XML file!</font>";
                    }
                }
            } 
        </script>
    </head>
    <body>
        <h1>Feedback Form</h1>
      <p>Please fill out this form to help 
         us improve our site.</p>

      <form method="post" action="#">
         <p><label>Name:</label><br /> 
               <input name="name" id="name" type="text" size="25" onblur="validateField(this)"/>&nbsp;<label id="nameRequiredError"/>
         </p>
 
         <!-- <textarea> creates a multiline textbox -->
         <p><label>Comments:</label><br />
            <textarea name="comments" id="comments" placeholder="Enter comments here." onblur="validateField(this)"
               rows="4" cols="36"></textarea>&nbsp;<label id="commentsRequiredError"/>
         </p>

         <p><label>E-mail Address:</label><br /> 
            <input name="email" id="email" type="text" size="25" placeholder="Please type a valid registered e-mail here" onblur="javascript:if(validateField(this)){validateEmail();}else{document.getElementById('displayEmailError').innerHTML = '';}"  />&nbsp;<label id="emailRequiredError"></label>&nbsp;<b><label id="displayEmailError"></label></b>
         </p>              

         <p>
            <strong>Things you liked:</strong><br />

            <label>Site design</label>
               <input name="thingsliked" id="thingsliked" type="checkbox"
                  value="Design"/>
            <label>Links</label>
               <input name="thingsliked" id="thingsliked" type="checkbox" 
                  value="Links"/>
            <label>Ease of use</label>
               <input name="thingsliked" id="thingsliked" type="checkbox" 
                  value="Ease"/> 
            <label>Images</label> 
               <input name="thingsliked" id="thingsliked" type="checkbox" 
                  value="Images"/>
            <label>Source code</label>
               <input name="thingsliked" id="thingsliked" type="checkbox" 
                  value="Code"/>
         </p>

         <!-- <input type = "radio" /> creates a radio -->
         <!-- button. The difference between radio buttons -->
         <!-- and checkboxes is that only one radio button -->
         <!-- in a group can be selected. -->
         <p>
            <strong>How did you get to our site?:</strong><br />

            <label>Search engine</label>
               <input name="howtosite" id="howtosite" type="radio"
                  value="search engine" checked="checked"/>
            <label>Links from another site</label>
               <input name="howtosite" id="howtosite" type="radio" 
                  value="link" /> 
            <label>Deitel.com Web site</label>
               <input name="howtosite" id="howtosite" type="radio" 
                  value="deitel.com" />
            <label>Reference in a book</label>
               <input name="howtosite" id="howtosite" type="radio" 
                  value="book" />
            <label>Other</label>
               <input name="howtosite" id="howtosite" type="radio" 
                  value="other" />
         </p>

         <p>
            <label>Rate our site:</label> 

                <!-- the <select> tag presents a drop-down -->
                <!-- list with choices indicated by the -->
                <!-- <option> tags -->
               <select name = "rating">
                  <option selected = "selected">Amazing</option>
                  <option>10</option>
                  <option>9</option>
                  <option>8</option>
                  <option>7</option>
                  <option>6</option>
                  <option>5</option>
                  <option>4</option>
                  <option>3</option>
                  <option>2</option>
                  <option>1</option>
                  <option>Awful</option>
               </select>
         </p>

         <p>
            <input type="submit" onclick="validateAll();return false;" value="Submit" />
            <input type="reset" value="Clear" />
         </p>   
      </form>
    </body>
</html>